import unittest
from scanner import ymd2ordinal
from scanner import next_date
from scanner import weekday
from scanner import scanner


class TestNextDate(unittest.TestCase):
    def _test_helper(self, func, tests, answers):
        results = [func(_) for _ in tests]
        for (_1, _2) in zip(results, answers):
            self.assertEqual(_1, _2)


    def test_next_date(self):
        tests = [
            [2012, 2, 28], [2012, 2, 29], [2012, 3, 28],
            [2012, 3, 29], [2012, 3, 31], [2012, 12, 31],
            [2000, 2, 28], [2000, 2, 29], [2000, 3, 28],
            [2000, 3, 29], [2000, 3, 31], [2000, 12, 31],
            [1999, 2, 28], [1999, 3, 28], [1999, 3, 29],
            [1999, 3, 31], [1999, 12, 31],
            [1900, 2, 28], [1900, 3, 28], [1900, 3, 29],
            [1900, 3, 31], [1900, 12, 31],
        ]
        answers = [
            [2012, 2, 29], [2012, 3, 1], [2012, 3, 29],
            [2012, 3, 30], [2012, 4, 1], [2013, 1, 1],
            [2000, 2, 29], [2000, 3, 1], [2000, 3, 29],
            [2000, 3, 30], [2000, 4, 1], [2001, 1, 1],
            [1999, 3, 1], [1999, 3, 29], [1999, 3, 30],
            [1999, 4, 1], [2000, 1, 1],
            [1900, 3, 1], [1900, 3, 29], [1900, 3, 30],
            [1900, 4, 1], [1901, 1, 1],
        ]
        self._test_helper(next_date, tests, answers)

    def test_ymd2ordinal(self):
        tests = [
            [2012, 2, 28], [2012, 2, 29], [2012, 3, 28],
            [2012, 3, 29], [2012, 3, 31], [2012, 12, 31],
            [2000, 2, 28], [2000, 2, 29], [2000, 3, 28],
            [2000, 3, 29], [2000, 3, 31], [2000, 12, 31],
            [1999, 2, 28], [1999, 3, 28], [1999, 3, 29],
            [1999, 3, 31], [1999, 12, 31],
            [1900, 2, 28], [1900, 3, 28], [1900, 3, 29],
            [1900, 3, 31], [1900, 12, 31],
        ]
        answers = [
            734561, 734562, 734590, 734591, 734593, 734868,
            730178, 730179, 730207, 730208, 730210, 730485,
            729813, 729841, 729842, 729844, 730119,
            693654, 693682, 693683, 693685, 693960
        ]
        self._test_helper(ymd2ordinal, tests, answers)

    def test_weekday(self):
        tests = [
            [2012, 2, 28], [2012, 2, 29], [2012, 3, 28],
            [2012, 3, 29], [2012, 3, 31], [2012, 12, 31],
            [2000, 2, 28], [2000, 2, 29], [2000, 3, 28],
            [2000, 3, 29], [2000, 3, 31], [2000, 12, 31],
            [1999, 2, 28], [1999, 3, 28], [1999, 3, 29],
            [1999, 3, 31], [1999, 12, 31],
            [1900, 2, 28], [1900, 3, 28], [1900, 3, 29],
            [1900, 3, 31], [1900, 12, 31],
        ]
        answers = [
            1, 2, 2, 3, 5, 0, 0, 1, 1, 2, 4,
            6, 6, 6, 0, 2, 4, 2, 2, 3, 5, 0
        ]
        self._test_helper(weekday, tests, answers)


    def test_scanner(self):
        data = scanner('./../raw_training_data/data_2015_1.txt')
        self.assertIsInstance(data, list)



def main():
    unittest.main()


if __name__ == '__main__':
    main()
